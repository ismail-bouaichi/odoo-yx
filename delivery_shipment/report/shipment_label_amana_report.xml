<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="paperformat_shipment_label" model="report.paperformat">
            <field name="name">Shipment Label Format</field>
            <field name="format">custom</field>
            <field name="page_width">103</field>
            <field name="page_height">143</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">0</field>
            <field name="margin_bottom">0</field>
            <field name="margin_left">0</field>
            <field name="margin_right">0</field>
            <field name="header_spacing">0</field>
            <field name="dpi">96</field>
            <field name="disable_shrinking" eval="True"/>
        </record>

        <record id="action_report_shipment_label_amana" model="ir.actions.report">
            <field name="name">Etiquette Amana</field>
            <field name="model">delivery.shipment</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">delivery_shipment.report_shipment_label_amana</field>
            <field name="report_file">delivery_shipment.report_shipment_label_amana</field>
            <field name="binding_model_id" ref="model_delivery_shipment"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="delivery_shipment.paperformat_shipment_label"/>
        </record>

        <template id="report_shipment_label_amana">
            <t t-call="web.basic_layout">
                <style>
                   
                @font-face {
                    font-family: 'DSTR_CODEBAR';
                    src: url('/delivery_shipment/static/src/fonts/DSTRC_.TTF') format('truetype');
                }

    
                .barcode-style {
                    font-family: 'DSTR_CODEBAR', sans-serif;
                    font-weight: normal;
                    line-height: 1.5;
                     
                    letter-spacing: 0px; 
                    white-space: nowrap;
                    text-transform: uppercase;  
                }

                         
                        body, html {
                            color: #000000 !important;
                            font-family: Arial, Helvetica, sans-serif;
                            margin: 0 !important;
                            padding: 0 !important;
                            width: 100% !important;
                        }
                    
                     
                    .page {
                        width: 103mm !important;    
                        height: 143mm !important;   
                        box-sizing: border-box;     
                        margin: 0;
                        padding: 2mm;
                        page-break-after: always;
                        page-break-inside: avoid;
                        position: relative;
                    }
                    .page:last-child { page-break-after: auto; }
                    
                    .label-container { 
                        width: 100%; 
                        height: 100%;
                        border: 2px solid black; 
                        border-collapse: collapse;
                    }
                    .border-bottom-thick { border-bottom: 2px solid black; }
                    .border-right-thick { border-right: 2px solid black; }
                    
                    .logo-img { max-height: 35px; max-width: 100%; }
                    .text-lg { font-size: 18px; font-weight: bold; line-height: 1; }
                    .text-sm { font-size: 10px; }
                    .text-xs { font-size: 9px; }
                    .font-bold { font-weight: bold; }
                    td { vertical-align: top; }
                </style>

                <t t-foreach="docs" t-as="shipment">
                    <t t-foreach="shipment.package_ids" t-as="package">
                        <div class="page">
                            <table class="label-container">
                                <tr class="border-bottom-thick">
                                    <td colspan="2" style="padding: 5px; vertical-align: middle;">
                                        <table class="table-borderless" style="width: 100%; border: none;">
                                            <tr>
                                                <td style="width: 25%;">
                                                    <img src="/delivery_shipment/static/src/img/Barid.png" class="logo-img" alt="Barid"/>
                                                </td>
                                                <td style="width: 50%; text-align: center;">
                                                    <span class="text-lg">Amana Express</span>
                                                </td>
                                                <td style="width: 25%; text-align: right;">
                                                    <img src="/delivery_shipment/static/src/img/Amana.png" class="logo-img" alt="Amana"/>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr class="border-bottom-thick">
                                    <td colspan="2" style="padding: 5px; text-align: center;">
                                        <div class="text-sm" style="text-align: left;">N° du colis pour le suivi :</div>
                                        <t t-if="package.gab">
                                            <t t-set="barcode_text" t-value="'*' + package.gab + '*'"/>
                                            
                                            <div style="margin: 0 auto; text-align: center; padding-top: 15px;">
                                                <span class="barcode-style" style="font-size: 18px;" t-esc="barcode_text"/>
                                            </div>
                                        </t>
                                    </td>
                                </tr>

                                <tr class="border-bottom-thick">
                                    <td class="border-right-thick" style="width: 45%; padding: 5px;">
                                        <div class="text-xs">
                                            Tél Expéditeur : 
                                            <span class="font-bold"><t t-esc="shipment.picking_id.company_id.phone or ''"/></span>
                                        </div>
                                        <div class="text-xs font-bold" style="text-transform: uppercase; margin-top: 4px;" t-esc="shipment.picking_id.company_id.name or ''"/>
                                    </td>
                                    <td style="width: 55%; padding: 5px; font-size: 9px;">
                                        <div style="width: 100%; overflow: hidden;">
                                            <span>Poids: <span class="font-bold"><t t-esc="shipment.weight or 0"/> Kg</span></span>
                                            <span style="float: right;">VD: <span class="font-bold"><t t-esc="package.vd or 0"/></span></span>
                                        </div>
                                        <div>POD : <span class="font-bold"><t t-esc="shipment.pod or ''"/></span></div>
                                        <div>CRBT Espèces : <span class="font-bold"><t t-esc="shipment.crbt_espece or 0"/></span></div>
                                        <div>CRBT Chèque : <span class="font-bold"><t t-esc="shipment.crbt_cheque or ''"/></span></div>
                                    </td>
                                </tr>

                                <tr class="border-bottom-thick">
                                    <td colspan="2" style="padding: 5px;">
                                        <div class="text-sm font-bold">
                                            Destinataire : <span t-esc="shipment.partner_id.name or ''"/>
                                        </div>
                                        <div class="text-xs" style="margin-top: 2px;">
                                            <div>CP: <span class="font-bold"><t t-esc="shipment.partner_id.zip or ''"/></span> | Ville: <span class="font-bold"><t t-esc="shipment.partner_id.city or ''"/></span></div>
                                            <div>Adresse: <span class="font-bold"><t t-esc="shipment.partner_id.street or ''"/></span> <span t-if="shipment.partner_id.street2" class="font-bold"><t t-esc="shipment.partner_id.street2"/></span></div>
                                            <div>Pays: <span class="font-bold"><t t-esc="shipment.partner_id.country_id.name or ''"/></span></div>
                                            <div style="margin-top:2px;">Tél: <span class="font-bold"><t t-esc="shipment.ms_destinataire or ''"/></span></div>
                                            <div t-if="shipment.code_point_relais">Relais: <span class="font-bold"><t t-esc="shipment.code_point_relais"/></span></div>
                                        </div>
                                    </td>
                                </tr>

                                <tr>
                                    <td colspan="2" style="padding: 5px;">
                                        <div class="text-sm font-bold">
                                            SENS : <span t-if="shipment.is_fragile">1_POUR_OUI</span><span t-else="">0_POUR_NON</span>
                                        </div>
                                        <div class="text-xs" style="margin-top: 2px;">
                                            Dims: <span class="font-bold"><t t-esc="shipment.dimension_length or 0"/>x<t t-esc="shipment.dimension_width or 0"/>x<t t-esc="shipment.dimension_height or 0"/></span>
                                        </div>
                                        <div class="text-xs">
                                            Ref Fournisseur: <span class="font-bold"><t t-esc="shipment.supplier_code or ''"/></span> | BL: <span class="font-bold"><t t-esc="shipment.picking_id.name or ''"/></span>
                                        </div>

                                        <div style="text-align: center; margin-top: 15px;" t-if="package.gab">
                                            <t t-set="barcode_text" t-value="'*' + package.gab + '*'"/>
                                            <div style="width: 100%; text-align: center;">
                                                <span class="barcode-style" style="font-size: 18px;" t-esc="barcode_text"/>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>